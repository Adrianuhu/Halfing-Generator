<html>

<head>

    <title>Avatar Maker</title>

    <script>
        function createRandomHalfling() {
            var bodynum = generateRandomInt(1, 7);
            var headnum = generateRandomInt(1, 20);
            var mouthnum = generateRandomInt(1, 9);
            var nosenum = generateRandomInt(1, 11);
            var eyesnum = generateRandomInt(1, 12);
            var hairnum = generateRandomInt(1, 11);
            var accessorynum = generateRandomInt(1, 1);

            createHalfling(bodynum, headnum, mouthnum, nosenum, eyesnum, hairnum, accessorynum, "halflingContainer", true);
        }

        function createHalfling(bodynum, headnum, mouthnum, nosenum, eyesnum, hairnum, accessorynum, container, generate) {

            var size = 800;
            // CANVAS
            var cont = document.getElementById(container);
            if (generate) cont.innerHTML = "";
            var canvas = document.createElement("canvas");
            canvas.className = "canvas";
            cont.appendChild(canvas);

            // BODY
            var body = new Image();
            var bodyname = "body/body" + bodynum + ".svg";
            body.width = size;
            body.height = size;
            body.src = bodyname;

            // HEAD
            var head = new Image();
            var headname = "head/head" + headnum + ".svg";
            head.src = headname;

            // MOUTH
            var mouth = new Image();
            var mouthname = "mouth/mouth" + mouthnum + ".svg";
            mouth.src = mouthname;


            // NOSE
            var nose = new Image();
            var nosename = "nose/nose" + nosenum + ".svg";
            nose.src = nosename;

            // EYES
            var eyes = new Image();
            var eyesname = "eyes/eyes" + eyesnum + ".svg";
            eyes.src = eyesname;

            // // EARS
            // var ears = new Image();
            // var earsname = "ears/ears" + earsnum + ".svg";
            // ears.src = earsname;

            // HAIR
            var hair = new Image();
            var hairname = "hair/hair" + hairnum + ".svg";
            hair.src = hairname;

            // ACCESSORY
            var accessory = new Image();
            var accessoryname = "accessory/accessory" + accessorynum + ".svg";
            accessory.src = accessoryname;



            // Wait until body part is loaded and then call the function that displays all images

            // BODY
            body.onload = function() {
                buildHalfing(canvas);
            }

            // HEAD
            head.onload = function() {
                buildHalfing(canvas);
            }

            // MOUTH
            mouth.onload = function() {
                buildHalfing(canvas);
            }

            // NOSE
            nose.onload = function() {
                buildHalfing(canvas);
            }

            // EYES
            eyes.onload = function() {
                buildHalfing(canvas);
            }

            // HAIR
            hair.onload = function() {
                buildHalfing(canvas);
            }

            // ACCESSORY
            accessory.onload = function() {
                buildHalfing(canvas);
            }

            // This is the function that displays all images
            function buildHalfing(canvas) {
                var ctx = canvas.getContext('2d');

                canvas.width = size;
                canvas.height = size;

                // ADD RANDOM BACKGROUND COLOUR
                // var r = Math.floor(Math.random() * (255 - 100 + 1) + 100);
                // var g = Math.floor(Math.random() * (255 - 100 + 1) + 100);
                // var b = Math.floor(Math.random() * (255 - 100 + 1) + 100);
                // var bgcol = "#" + r.toString(16) + g.toString(16) + b.toString(16);
                // var hue = Math.floor(Math.random() * 360);
                // var bgcol = 'hsl(' + hue + ', 10%, 50%)';
                var bgcol = "#FFFFFF";
                ctx.fillStyle = bgcol;
                ctx.fillRect(0, 0, size, size);

                // This is the list of all parts and where they should go (centered, and height)

                // BODY
                ctx.drawImage(body, 0, 0);

                // HEAD
                ctx.drawImage(head, 0, 0);

                // MOUTH
                ctx.drawImage(mouth, 0, 0);

                // NOSE
                ctx.drawImage(nose, 0, 0);

                // EYES
                ctx.drawImage(eyes, 0, 0);

                // HAIR
                ctx.drawImage(hair, 0, 0);

                // ACCESORY
                ctx.drawImage(accessory, 0, 0);
            }
        }

        function generateRandomInt(min, max) {
            return Math.round(Math.random() * (max - min) + min);
        }
    </script>
</head>

<style>
    .canvas {
        border-radius: 100%;
    }
    
    #halflingContainer canvas {
        width: 90%;
    }
</style>

<body bgcolor="#FFFFFF">

    <div align="center">
        <br><br>
        <!-- Draw the canvas, centered, add the border width and colour -->
        <div id="halflingContainer"></div>
        <br><br>
        <!-- Create a button that reloads the page, generating a new image -->
        <button style="font-size : 50px; width: 30%; height: 100px; border-radius: 50px;" onClick="createRandomHalfling();">Generate!</button>

    </div>

    <script>
        createRandomHalfling();
    </script>
</body>

</html>